## 1.字符

字符的标识，即码位

字符的具体表述取决于**编码。编码**就是码位和字节序列之间转换是使用的算法。

编码: 码位 -> 字节序列

  In [59]: b = '你好，python'.encode()  In [60]: b  Out[60]: b'\xe4\xbd\xa0\xe5\xa5\xbd\xef\xbc\x8cpython'  

解码：字节序列 - > 码位  bytes.decode('utf8')

  In [61]: b.decode()  Out[61]: '你好，python'  

## 2.字节

 bytes bytearray

 构建方法

1. bytes构造函数：str 类型+encoding 类型 
   
   In [76]: bytes('你好，python', encoding='utf8')  

2. 可迭代对象，提供一个0~255 之间的值
   
   In [62]: b_arr = bytearray(b)     In [63]: b_array  Out[63]: bytearray(b'\xe4\xbd\xa0\xe5\xa5\xbd\xef\xbc\x8cpython')  

**编码错误的处理方法**

1. 当 encode() 方法无法编码某个特殊字符是，默认抛出异常 UnicodeEcodeError
2. 使用errors=ignore 跳过异常      encode('cp437', errors='ignore')（字符缺失，不妥）
3. 使用     errors='replace',无法编码的用 ? 替换
4. 使用     errors='xmlcharrefreloace' ,无法编码的字符替换为 xml 实体

## 4.解码错误的处理方法

不是每个字节都包含 有效的ASCII 字符

2. 1. decode 遇到无法解码的字节，默认抛出 UnicodeDecodeError

3. 使用errors='ignore'

4. 使用errors='replace',无法解码的被替换为  
   
   In [103]: b'\xe9'.decode('utf8', errors='ignore')  Out[103]: ''     In [104]: b'\xe9'.decode('utf8', errors='replace')  Out[104]: ' '  

## 5.处理文本的最佳实践

Unicode三明治

<img src="https://gitee.com/zbw2535463841/images-bed/raw/master/2022/01/01/image-20211125224002907.png" alt="image-20211125224002907" style="zoom:80%;" />

读写文件显示指定 encoding=参数，不要依赖默认的编码/解码方式

## 6.os 模块中的字符串和字节序列

os.listdir 支持 字符串 和字节序列作为参数（双模式API,例如 re.complite(rb'xxx')）

```python
In [138]: os.listdir('g:/.')  
Out[138]:   ['wsl_update_x64.msi',  '日语']
In [139]: os.listdir(b'g:/.')  
Out[139]:   [b'wsl_update_x64.msi',  b'\xe6\x97\xa5\xe8\xaf\xad']  
```

这一特性允许我们处理任何的字符串，不管有多少鬼符
os.fsencode 如果filename 是 str 类型，转化为 bytes(使用 sys.getfilesystemencoding() 的编解码器)

os.fsdecode 如果filename 是 bytes 类型，转化为 str（使用 sys.getfilesystemencoding() 的编解码器）
